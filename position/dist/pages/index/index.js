;require('./../../runtime');(wx["webpackJsonp"] = wx["webpackJsonp"] || []).push([[3],{

/***/ 21:
/***/ (function(module, exports) {

//index.js
var app = getApp();
Page({
  data: {
    longitude: 113.324520,
    latitude: 23.099994,
    boxDisplay: true,
    repairFeedbackDisplay: false,
    disabled: true,
    timer: "",
    feedbackErea: "",
    submitFeedback: [],
    markers: [{
      iconPath: "../img/greenBus.png",
      id: 0,
      latitude: 30.495214532303866,
      longitude: 114.39670774090536,
      width: 30,
      height: 30
    }],
    // 故障反馈类型
    feedbacks: [{
      name: 'location',
      value: '校车的定位错误；定位与实际位置偏离'
    }, {
      name: 'state',
      value: '校车颜色标示的状态与校车的实际状态不符'
    }, {
      name: 'number',
      value: '校车车号不对应'
    }]
  },
  onLoad: function onLoad(options) {
    console.log("onLoad");
    var that = this;
    this.mapCtx = wx.createMapContext('myMap'); //获取当前位置

    wx.getLocation({
      type: 'gcj02',
      //返回可以用于wx.openLocation的经纬度
      success: function success(res) {
        var latitude = res.latitude;
        var longitude = res.longitude;
        that.setData({
          latitude: latitude,
          longitude: longitude
        });
      }
    });
  },
  onReady: function onReady(e) {
    // 请求车辆定位信息
    console.log("onReady");
    var that = this;
    wx.login({
      success: function success(res) {
        if (res.code) {
          var authorizeUrl = app.BASE_URL + '/user/session';
          var authorizeData = {
            code: res.code
          };
          app.request(authorizeUrl, 'POST', authorizeData, function (res) {
            console.log('/user/session');
            console.log(res);
            wx.setStorageSync('token', res.header.Authorization);
            var busPositionUrl = app.BASE_URL + '/bus/all';
            var token = wx.getStorageSync('token');
            app.request(busPositionUrl, 'GET', '', function (res) {
              console.log(res);
              var getLatitude = res.data.bused[0].position.latitude;
              var getLongitude = res.data.bused[0].position.longitude.toString();
              var getId = res.data.bused[0].id;
              that.setData({
                markers: [{
                  iconPath: "../img/greenBus.png",
                  id: getId,
                  latitude: getLatitude,
                  longitude: getLongitude,
                  width: 30,
                  height: 30
                }]
              });
              console.log(that.data.markers);
            }, function (res) {}, {
              'Authorization': token
            }, '');
          }, function (res) {}, {
            'content-type': 'application/json'
          }, '');
        }
      }
    });
  },
  onShow: function onShow(e) {
    console.log("onShow");
  },
  // 故障反馈面板是否显示
  repair: function repair() {
    this.setData({
      boxDisplay: false,
      repairFeedbackDisplay: true
    });
  },
  // 获取checkbox的值
  checkboxChange: function checkboxChange(e) {
    this.setData({
      submitFeedback: e.detail.value
    });
  },
  //获取反馈建议texterea的值
  feedbackErea: function feedbackErea(e) {
    this.setData({
      feedbackErea: e.detail.value
    });
  },
  // 提交反馈
  submitFeedback: function submitFeedback(e) {
    var that = this;
    var feedbackData = {
      type: that.data.submitFeedback.toString(),
      text: that.data.feedbackErea
    };
    var token = wx.getStorageSync('token');
    var feedbackUrl = app.BASE_URL + '/feedback';
    app.request(feedbackUrl, 'POST', feedbackData, function (res) {
      console.log('feedbackUrl');
      console.log(res);
      wx.showToast({
        title: '成功',
        icon: 'succes',
        duration: 1000,
        mask: true
      });
      that.setData({
        repairFeedbackDisplay: false,
        boxDisplay: true
      });
    }, function (res) {}, {
      'Authorization': token
    }, '');
  },
  repairFeedbackBox: function repairFeedbackBox() {
    this.setData({
      repairFeedbackDisplay: false,
      boxDisplay: true
    });
  }
});

/***/ })

},[[21,0]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9wYWdlcy9pbmRleC9pbmRleC5qcyJdLCJuYW1lcyI6WyJhcHAiLCJnZXRBcHAiLCJQYWdlIiwiZGF0YSIsImxvbmdpdHVkZSIsImxhdGl0dWRlIiwiYm94RGlzcGxheSIsInJlcGFpckZlZWRiYWNrRGlzcGxheSIsImRpc2FibGVkIiwidGltZXIiLCJmZWVkYmFja0VyZWEiLCJzdWJtaXRGZWVkYmFjayIsIm1hcmtlcnMiLCJpY29uUGF0aCIsImlkIiwid2lkdGgiLCJoZWlnaHQiLCJmZWVkYmFja3MiLCJuYW1lIiwidmFsdWUiLCJvbkxvYWQiLCJvcHRpb25zIiwiY29uc29sZSIsImxvZyIsInRoYXQiLCJtYXBDdHgiLCJ3eCIsImNyZWF0ZU1hcENvbnRleHQiLCJnZXRMb2NhdGlvbiIsInR5cGUiLCJzdWNjZXNzIiwicmVzIiwic2V0RGF0YSIsIm9uUmVhZHkiLCJlIiwibG9naW4iLCJjb2RlIiwiYXV0aG9yaXplVXJsIiwiQkFTRV9VUkwiLCJhdXRob3JpemVEYXRhIiwicmVxdWVzdCIsInNldFN0b3JhZ2VTeW5jIiwiaGVhZGVyIiwiQXV0aG9yaXphdGlvbiIsImJ1c1Bvc2l0aW9uVXJsIiwidG9rZW4iLCJnZXRTdG9yYWdlU3luYyIsImdldExhdGl0dWRlIiwiYnVzZWQiLCJwb3NpdGlvbiIsImdldExvbmdpdHVkZSIsInRvU3RyaW5nIiwiZ2V0SWQiLCJvblNob3ciLCJyZXBhaXIiLCJjaGVja2JveENoYW5nZSIsImRldGFpbCIsImZlZWRiYWNrRGF0YSIsInRleHQiLCJmZWVkYmFja1VybCIsInNob3dUb2FzdCIsInRpdGxlIiwiaWNvbiIsImR1cmF0aW9uIiwibWFzayIsInJlcGFpckZlZWRiYWNrQm94Il0sIm1hcHBpbmdzIjoiOzs7OztBQUFBO0FBQ0EsSUFBTUEsR0FBRyxHQUFHQyxNQUFNLEVBQWxCO0FBQ0FDLElBQUksQ0FBQztBQUNIQyxNQUFJLEVBQUU7QUFDSkMsYUFBUyxFQUFFLFVBRFA7QUFFSkMsWUFBUSxFQUFFLFNBRk47QUFJSkMsY0FBVSxFQUFDLElBSlA7QUFLSkMseUJBQXFCLEVBQUMsS0FMbEI7QUFRSkMsWUFBUSxFQUFFLElBUk47QUFTSkMsU0FBSyxFQUFDLEVBVEY7QUFVSkMsZ0JBQVksRUFBQyxFQVZUO0FBV0pDLGtCQUFjLEVBQUMsRUFYWDtBQWFKQyxXQUFPLEVBQUUsQ0FDUDtBQUNFQyxjQUFRLEVBQUUscUJBRFo7QUFFRUMsUUFBRSxFQUFFLENBRk47QUFHRVQsY0FBUSxFQUFFLGtCQUhaO0FBSUVELGVBQVMsRUFBRSxrQkFKYjtBQUtFVyxXQUFLLEVBQUUsRUFMVDtBQU1FQyxZQUFNLEVBQUU7QUFOVixLQURPLENBYkw7QUF1Qko7QUFDQUMsYUFBUyxFQUFFLENBQ1Q7QUFBRUMsVUFBSSxFQUFFLFVBQVI7QUFBb0JDLFdBQUssRUFBRTtBQUEzQixLQURTLEVBRVQ7QUFBRUQsVUFBSSxFQUFFLE9BQVI7QUFBaUJDLFdBQUssRUFBRTtBQUF4QixLQUZTLEVBR1Q7QUFBRUQsVUFBSSxFQUFFLFFBQVI7QUFBa0JDLFdBQUssRUFBRTtBQUF6QixLQUhTO0FBeEJQLEdBREg7QUFnQ0hDLFFBQU0sRUFBRSxnQkFBVUMsT0FBVixFQUFtQjtBQUN6QkMsV0FBTyxDQUFDQyxHQUFSLENBQVksUUFBWjtBQUNBLFFBQU1DLElBQUksR0FBRyxJQUFiO0FBQ0EsU0FBS0MsTUFBTCxHQUFjQyxFQUFFLENBQUNDLGdCQUFILENBQW9CLE9BQXBCLENBQWQsQ0FIeUIsQ0FJekI7O0FBQ0FELE1BQUUsQ0FBQ0UsV0FBSCxDQUFlO0FBQ2JDLFVBQUksRUFBRSxPQURPO0FBQ0U7QUFDZkMsYUFGYSxtQkFFTEMsR0FGSyxFQUVBO0FBQ1gsWUFBTTFCLFFBQVEsR0FBRzBCLEdBQUcsQ0FBQzFCLFFBQXJCO0FBQ0EsWUFBTUQsU0FBUyxHQUFHMkIsR0FBRyxDQUFDM0IsU0FBdEI7QUFDQW9CLFlBQUksQ0FBQ1EsT0FBTCxDQUFhO0FBQ1gzQixrQkFBUSxFQUFFQSxRQURDO0FBRVhELG1CQUFTLEVBQUVBO0FBRkEsU0FBYjtBQUlEO0FBVFksS0FBZjtBQVdELEdBaERFO0FBaURINkIsU0FBTyxFQUFFLGlCQUFVQyxDQUFWLEVBQWE7QUFDcEI7QUFDQVosV0FBTyxDQUFDQyxHQUFSLENBQVksU0FBWjtBQUNBLFFBQU1DLElBQUksR0FBRyxJQUFiO0FBRUFFLE1BQUUsQ0FBQ1MsS0FBSCxDQUFTO0FBQ1BMLGFBQU8sRUFBRSxpQkFBQUMsR0FBRyxFQUFJO0FBQ2QsWUFBSUEsR0FBRyxDQUFDSyxJQUFSLEVBQWM7QUFDWixjQUFJQyxZQUFZLEdBQUdyQyxHQUFHLENBQUNzQyxRQUFKLEdBQWUsZUFBbEM7QUFDQSxjQUFJQyxhQUFhLEdBQUc7QUFBRUgsZ0JBQUksRUFBRUwsR0FBRyxDQUFDSztBQUFaLFdBQXBCO0FBQ0FwQyxhQUFHLENBQUN3QyxPQUFKLENBQVlILFlBQVosRUFBMEIsTUFBMUIsRUFBa0NFLGFBQWxDLEVBQWlELFVBQUFSLEdBQUcsRUFBSTtBQUN0RFQsbUJBQU8sQ0FBQ0MsR0FBUixDQUFZLGVBQVo7QUFDQUQsbUJBQU8sQ0FBQ0MsR0FBUixDQUFZUSxHQUFaO0FBQ0FMLGNBQUUsQ0FBQ2UsY0FBSCxDQUFrQixPQUFsQixFQUEyQlYsR0FBRyxDQUFDVyxNQUFKLENBQVdDLGFBQXRDO0FBQ0EsZ0JBQU1DLGNBQWMsR0FBRzVDLEdBQUcsQ0FBQ3NDLFFBQUosR0FBZSxVQUF0QztBQUNBLGdCQUFNTyxLQUFLLEdBQUduQixFQUFFLENBQUNvQixjQUFILENBQWtCLE9BQWxCLENBQWQ7QUFDQTlDLGVBQUcsQ0FBQ3dDLE9BQUosQ0FBWUksY0FBWixFQUE0QixLQUE1QixFQUFtQyxFQUFuQyxFQUF1QyxVQUFBYixHQUFHLEVBQUk7QUFDNUNULHFCQUFPLENBQUNDLEdBQVIsQ0FBWVEsR0FBWjtBQUNBLGtCQUFNZ0IsV0FBVyxHQUFHaEIsR0FBRyxDQUFDNUIsSUFBSixDQUFTNkMsS0FBVCxDQUFlLENBQWYsRUFBa0JDLFFBQWxCLENBQTJCNUMsUUFBL0M7QUFDQSxrQkFBTTZDLFlBQVksR0FBR25CLEdBQUcsQ0FBQzVCLElBQUosQ0FBUzZDLEtBQVQsQ0FBZSxDQUFmLEVBQWtCQyxRQUFsQixDQUEyQjdDLFNBQTNCLENBQXFDK0MsUUFBckMsRUFBckI7QUFDQSxrQkFBTUMsS0FBSyxHQUFHckIsR0FBRyxDQUFDNUIsSUFBSixDQUFTNkMsS0FBVCxDQUFlLENBQWYsRUFBa0JsQyxFQUFoQztBQUNBVSxrQkFBSSxDQUFDUSxPQUFMLENBQWE7QUFDWHBCLHVCQUFPLEVBQUUsQ0FDUDtBQUNFQywwQkFBUSxFQUFFLHFCQURaO0FBRUVDLG9CQUFFLEVBQUVzQyxLQUZOO0FBR0UvQywwQkFBUSxFQUFFMEMsV0FIWjtBQUlFM0MsMkJBQVMsRUFBRThDLFlBSmI7QUFLRW5DLHVCQUFLLEVBQUUsRUFMVDtBQU1FQyx3QkFBTSxFQUFFO0FBTlYsaUJBRE87QUFERSxlQUFiO0FBWUFNLHFCQUFPLENBQUNDLEdBQVIsQ0FBWUMsSUFBSSxDQUFDckIsSUFBTCxDQUFVUyxPQUF0QjtBQUNELGFBbEJELEVBa0JHLFVBQUFtQixHQUFHLEVBQUksQ0FBRyxDQWxCYixFQWtCZTtBQUFFLCtCQUFpQmM7QUFBbkIsYUFsQmYsRUFrQjJDLEVBbEIzQztBQW1CRCxXQXpCRCxFQXlCRyxVQUFBZCxHQUFHLEVBQUksQ0FBRyxDQXpCYixFQXlCZTtBQUFFLDRCQUFnQjtBQUFsQixXQXpCZixFQXlCdUQsRUF6QnZEO0FBMEJEO0FBQ0Y7QUFoQ00sS0FBVDtBQWtDRCxHQXhGRTtBQXlGSHNCLFFBQU0sRUFBRSxnQkFBVW5CLENBQVYsRUFBYTtBQUNuQlosV0FBTyxDQUFDQyxHQUFSLENBQVksUUFBWjtBQUNELEdBM0ZFO0FBNkZMO0FBQ0UrQixRQUFNLEVBQUMsa0JBQVU7QUFDZixTQUFLdEIsT0FBTCxDQUFhO0FBQ1gxQixnQkFBVSxFQUFFLEtBREQ7QUFFWEMsMkJBQXFCLEVBQUU7QUFGWixLQUFiO0FBSUQsR0FuR0U7QUFvR0g7QUFDQWdELGdCQUFjLEVBQUUsd0JBQVVyQixDQUFWLEVBQWE7QUFDM0IsU0FBS0YsT0FBTCxDQUFhO0FBQ1hyQixvQkFBYyxFQUFFdUIsQ0FBQyxDQUFDc0IsTUFBRixDQUFTckM7QUFEZCxLQUFiO0FBR0QsR0F6R0U7QUEwR0g7QUFDQVQsY0FBWSxFQUFFLHNCQUFVd0IsQ0FBVixFQUFhO0FBQ3pCLFNBQUtGLE9BQUwsQ0FBYTtBQUNYdEIsa0JBQVksRUFBRXdCLENBQUMsQ0FBQ3NCLE1BQUYsQ0FBU3JDO0FBRFosS0FBYjtBQUdELEdBL0dFO0FBZ0hIO0FBQ0FSLGdCQUFjLEVBQUMsd0JBQVN1QixDQUFULEVBQVc7QUFDeEIsUUFBTVYsSUFBSSxHQUFHLElBQWI7QUFDQSxRQUFNaUMsWUFBWSxHQUFHO0FBQUU1QixVQUFJLEVBQUVMLElBQUksQ0FBQ3JCLElBQUwsQ0FBVVEsY0FBVixDQUF5QndDLFFBQXpCLEVBQVI7QUFBNkNPLFVBQUksRUFBRWxDLElBQUksQ0FBQ3JCLElBQUwsQ0FBVU87QUFBN0QsS0FBckI7QUFDQSxRQUFNbUMsS0FBSyxHQUFHbkIsRUFBRSxDQUFDb0IsY0FBSCxDQUFrQixPQUFsQixDQUFkO0FBQ0EsUUFBTWEsV0FBVyxHQUFHM0QsR0FBRyxDQUFDc0MsUUFBSixHQUFlLFdBQW5DO0FBRUF0QyxPQUFHLENBQUN3QyxPQUFKLENBQVltQixXQUFaLEVBQXlCLE1BQXpCLEVBQWlDRixZQUFqQyxFQUErQyxVQUFBMUIsR0FBRyxFQUFJO0FBQ3BEVCxhQUFPLENBQUNDLEdBQVIsQ0FBWSxhQUFaO0FBQ0FELGFBQU8sQ0FBQ0MsR0FBUixDQUFZUSxHQUFaO0FBQ0FMLFFBQUUsQ0FBQ2tDLFNBQUgsQ0FBYTtBQUNYQyxhQUFLLEVBQUUsSUFESTtBQUVQQyxZQUFJLEVBQUUsUUFGQztBQUdQQyxnQkFBUSxFQUFFLElBSEg7QUFJUEMsWUFBSSxFQUFDO0FBSkUsT0FBYjtBQU1FeEMsVUFBSSxDQUFDUSxPQUFMLENBQWE7QUFDWHpCLDZCQUFxQixFQUFFLEtBRFo7QUFFWEQsa0JBQVUsRUFBRTtBQUZELE9BQWI7QUFJSCxLQWJELEVBYUcsVUFBQXlCLEdBQUcsRUFBSSxDQUFHLENBYmIsRUFhZTtBQUFFLHVCQUFpQmM7QUFBbkIsS0FiZixFQWEyQyxFQWIzQztBQWNELEdBcklFO0FBc0lIb0IsbUJBQWlCLEVBQUMsNkJBQVU7QUFDMUIsU0FBS2pDLE9BQUwsQ0FBYTtBQUNYekIsMkJBQXFCLEVBQUUsS0FEWjtBQUVYRCxnQkFBVSxFQUFFO0FBRkQsS0FBYjtBQUlEO0FBM0lFLENBQUQsQ0FBSixDIiwiZmlsZSI6InBhZ2VzXFxpbmRleFxcaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL2luZGV4LmpzXG5jb25zdCBhcHAgPSBnZXRBcHAoKVxuUGFnZSh7XG4gIGRhdGE6IHtcbiAgICBsb25naXR1ZGU6IDExMy4zMjQ1MjAsXG4gICAgbGF0aXR1ZGU6IDIzLjA5OTk5NCxcblxuICAgIGJveERpc3BsYXk6dHJ1ZSxcbiAgICByZXBhaXJGZWVkYmFja0Rpc3BsYXk6ZmFsc2UsXG5cblxuICAgIGRpc2FibGVkOiB0cnVlLFxuICAgIHRpbWVyOlwiXCIsXG4gICAgZmVlZGJhY2tFcmVhOlwiXCIsXG4gICAgc3VibWl0RmVlZGJhY2s6W10sXG4gIFxuICAgIG1hcmtlcnM6IFtcbiAgICAgIHtcbiAgICAgICAgaWNvblBhdGg6IFwiLi4vaW1nL2dyZWVuQnVzLnBuZ1wiLFxuICAgICAgICBpZDogMCxcbiAgICAgICAgbGF0aXR1ZGU6IDMwLjQ5NTIxNDUzMjMwMzg2NixcbiAgICAgICAgbG9uZ2l0dWRlOiAxMTQuMzk2NzA3NzQwOTA1MzYsXG4gICAgICAgIHdpZHRoOiAzMCxcbiAgICAgICAgaGVpZ2h0OiAzMFxuICAgICAgfVxuICAgIF0sXG4gICAgLy8g5pWF6Zqc5Y+N6aaI57G75Z6LXG4gICAgZmVlZGJhY2tzOiBbXG4gICAgICB7IG5hbWU6ICdsb2NhdGlvbicsIHZhbHVlOiAn5qCh6L2m55qE5a6a5L2N6ZSZ6K+v77yb5a6a5L2N5LiO5a6e6ZmF5L2N572u5YGP56a7J30sXG4gICAgICB7IG5hbWU6ICdzdGF0ZScsIHZhbHVlOiAn5qCh6L2m6aKc6Imy5qCH56S655qE54q25oCB5LiO5qCh6L2m55qE5a6e6ZmF54q25oCB5LiN56ymJyB9LFxuICAgICAgeyBuYW1lOiAnbnVtYmVyJywgdmFsdWU6ICfmoKHovabovablj7fkuI3lr7nlupQnIH0sXG4gICAgXSxcbiAgXG4gIH0sXG4gIG9uTG9hZDogZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICBjb25zb2xlLmxvZyhcIm9uTG9hZFwiKVxuICAgIGNvbnN0IHRoYXQgPSB0aGlzXG4gICAgdGhpcy5tYXBDdHggPSB3eC5jcmVhdGVNYXBDb250ZXh0KCdteU1hcCcpXG4gICAgLy/ojrflj5blvZPliY3kvY3nva5cbiAgICB3eC5nZXRMb2NhdGlvbih7XG4gICAgICB0eXBlOiAnZ2NqMDInLCAvL+i/lOWbnuWPr+S7peeUqOS6jnd4Lm9wZW5Mb2NhdGlvbueahOe7j+e6rOW6plxuICAgICAgc3VjY2VzcyhyZXMpIHtcbiAgICAgICAgY29uc3QgbGF0aXR1ZGUgPSByZXMubGF0aXR1ZGVcbiAgICAgICAgY29uc3QgbG9uZ2l0dWRlID0gcmVzLmxvbmdpdHVkZVxuICAgICAgICB0aGF0LnNldERhdGEoe1xuICAgICAgICAgIGxhdGl0dWRlOiBsYXRpdHVkZSxcbiAgICAgICAgICBsb25naXR1ZGU6IGxvbmdpdHVkZSxcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9KVxuICB9LFxuICBvblJlYWR5OiBmdW5jdGlvbiAoZSkge1xuICAgIC8vIOivt+axgui9pui+huWumuS9jeS/oeaBr1xuICAgIGNvbnNvbGUubG9nKFwib25SZWFkeVwiKVxuICAgIGNvbnN0IHRoYXQgPSB0aGlzXG5cbiAgICB3eC5sb2dpbih7XG4gICAgICBzdWNjZXNzOiByZXMgPT4ge1xuICAgICAgICBpZiAocmVzLmNvZGUpIHtcbiAgICAgICAgICBsZXQgYXV0aG9yaXplVXJsID0gYXBwLkJBU0VfVVJMICsgJy91c2VyL3Nlc3Npb24nXG4gICAgICAgICAgbGV0IGF1dGhvcml6ZURhdGEgPSB7IGNvZGU6IHJlcy5jb2RlIH1cbiAgICAgICAgICBhcHAucmVxdWVzdChhdXRob3JpemVVcmwsICdQT1NUJywgYXV0aG9yaXplRGF0YSwgcmVzID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCcvdXNlci9zZXNzaW9uJylcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcylcbiAgICAgICAgICAgIHd4LnNldFN0b3JhZ2VTeW5jKCd0b2tlbicsIHJlcy5oZWFkZXIuQXV0aG9yaXphdGlvbilcbiAgICAgICAgICAgIGNvbnN0IGJ1c1Bvc2l0aW9uVXJsID0gYXBwLkJBU0VfVVJMICsgJy9idXMvYWxsJ1xuICAgICAgICAgICAgY29uc3QgdG9rZW4gPSB3eC5nZXRTdG9yYWdlU3luYygndG9rZW4nKVxuICAgICAgICAgICAgYXBwLnJlcXVlc3QoYnVzUG9zaXRpb25VcmwsICdHRVQnLCAnJywgcmVzID0+IHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKVxuICAgICAgICAgICAgICBjb25zdCBnZXRMYXRpdHVkZSA9IHJlcy5kYXRhLmJ1c2VkWzBdLnBvc2l0aW9uLmxhdGl0dWRlXG4gICAgICAgICAgICAgIGNvbnN0IGdldExvbmdpdHVkZSA9IHJlcy5kYXRhLmJ1c2VkWzBdLnBvc2l0aW9uLmxvbmdpdHVkZS50b1N0cmluZygpXG4gICAgICAgICAgICAgIGNvbnN0IGdldElkID0gcmVzLmRhdGEuYnVzZWRbMF0uaWRcbiAgICAgICAgICAgICAgdGhhdC5zZXREYXRhKHtcbiAgICAgICAgICAgICAgICBtYXJrZXJzOiBbXG4gICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGljb25QYXRoOiBcIi4uL2ltZy9ncmVlbkJ1cy5wbmdcIixcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGdldElkLFxuICAgICAgICAgICAgICAgICAgICBsYXRpdHVkZTogZ2V0TGF0aXR1ZGUsXG4gICAgICAgICAgICAgICAgICAgIGxvbmdpdHVkZTogZ2V0TG9uZ2l0dWRlLFxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogMzAsXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogMzBcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoYXQuZGF0YS5tYXJrZXJzKVxuICAgICAgICAgICAgfSwgcmVzID0+IHsgfSwgeyAnQXV0aG9yaXphdGlvbic6IHRva2VuIH0sICcnKVxuICAgICAgICAgIH0sIHJlcyA9PiB7IH0sIHsgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LCAnJylcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pICBcbiAgfSwgIFxuICBvblNob3c6IGZ1bmN0aW9uIChlKSB7XG4gICAgY29uc29sZS5sb2coXCJvblNob3dcIilcbiAgfSxcbiAgXG4vLyDmlYXpmpzlj43ppojpnaLmnb/mmK/lkKbmmL7npLpcbiAgcmVwYWlyOmZ1bmN0aW9uKCl7XG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIGJveERpc3BsYXk6IGZhbHNlLFxuICAgICAgcmVwYWlyRmVlZGJhY2tEaXNwbGF5OiB0cnVlLFxuICAgIH0pXG4gIH0sXG4gIC8vIOiOt+WPlmNoZWNrYm9455qE5YC8XG4gIGNoZWNrYm94Q2hhbmdlOiBmdW5jdGlvbiAoZSkge1xuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBzdWJtaXRGZWVkYmFjazogZS5kZXRhaWwudmFsdWVcbiAgICB9KVxuICB9LFxuICAvL+iOt+WPluWPjemmiOW7uuiurnRleHRlcmVh55qE5YC8XG4gIGZlZWRiYWNrRXJlYTogZnVuY3Rpb24gKGUpIHtcbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgZmVlZGJhY2tFcmVhOiBlLmRldGFpbC52YWx1ZVxuICAgIH0pXG4gIH0sXG4gIC8vIOaPkOS6pOWPjemmiFxuICBzdWJtaXRGZWVkYmFjazpmdW5jdGlvbihlKXtcbiAgICBjb25zdCB0aGF0ID0gdGhpc1xuICAgIGNvbnN0IGZlZWRiYWNrRGF0YSA9IHsgdHlwZTogdGhhdC5kYXRhLnN1Ym1pdEZlZWRiYWNrLnRvU3RyaW5nKCksIHRleHQ6IHRoYXQuZGF0YS5mZWVkYmFja0VyZWF9XG4gICAgY29uc3QgdG9rZW4gPSB3eC5nZXRTdG9yYWdlU3luYygndG9rZW4nKVxuICAgIGNvbnN0IGZlZWRiYWNrVXJsID0gYXBwLkJBU0VfVVJMICsgJy9mZWVkYmFjaydcblxuICAgIGFwcC5yZXF1ZXN0KGZlZWRiYWNrVXJsLCAnUE9TVCcsIGZlZWRiYWNrRGF0YSwgcmVzID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCdmZWVkYmFja1VybCcpXG4gICAgICBjb25zb2xlLmxvZyhyZXMpXG4gICAgICB3eC5zaG93VG9hc3Qoe1xuICAgICAgICB0aXRsZTogJ+aIkOWKnycsXG4gICAgICAgICAgICBpY29uOiAnc3VjY2VzJyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAwLFxuICAgICAgICAgICAgbWFzazp0cnVlXG4gICAgICAgIH0pXG4gICAgICAgIHRoYXQuc2V0RGF0YSh7XG4gICAgICAgICAgcmVwYWlyRmVlZGJhY2tEaXNwbGF5OiBmYWxzZSxcbiAgICAgICAgICBib3hEaXNwbGF5OiB0cnVlLFxuICAgICAgICB9KVxuICAgIH0sIHJlcyA9PiB7IH0sIHsgJ0F1dGhvcml6YXRpb24nOiB0b2tlbiB9LCAnJylcbiAgfSxcbiAgcmVwYWlyRmVlZGJhY2tCb3g6ZnVuY3Rpb24oKXtcbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgcmVwYWlyRmVlZGJhY2tEaXNwbGF5OiBmYWxzZSxcbiAgICAgIGJveERpc3BsYXk6IHRydWUsXG4gICAgfSlcbiAgfSxcblxufSlcbiJdLCJzb3VyY2VSb290IjoiIn0=