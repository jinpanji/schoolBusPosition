;require('./../../runtime');(wx["webpackJsonp"] = wx["webpackJsonp"] || []).push([[3],{

/***/ 3:
/***/ (function(module, exports) {

//index.js
var app = getApp();
Page({
  data: {
    longitude: 113.324520,
    latitude: 23.099994,
    boxDisplay: true,
    repairFeedbackDisplay: false,
    disabled: true,
    timer: "",
    feedbackErea: "",
    submitFeedback: [],
    markers: [{
      iconPath: "../img/greenBus.png",
      id: 0,
      latitude: 30.495214532303866,
      longitude: 114.39670774090536,
      width: 30,
      height: 30
    }],
    //路线
    polyline: [{
      points: [{
        longitude: 114.3953508139,
        latitude: 30.4935356094
      }, {
        longitude: 114.3964666128,
        latitude: 30.4932952419
      }, {
        longitude: 114.3960320950,
        latitude: 30.4916218979
      }, {
        longitude: 114.3934786320,
        latitude: 30.4919316074
      }, {
        longitude: 114.3934732676,
        latitude: 30.4914462413
      }, {
        longitude: 114.3920302391,
        latitude: 30.4914323737
      }, {
        longitude: 114.3920999765,
        latitude: 30.4900779583
      }, {
        longitude: 114.3915581703,
        latitude: 30.4886033344
      }, {
        longitude: 114.3913757801,
        latitude: 30.4864306503
      }, {
        longitude: 114.3916976452,
        latitude: 30.4846970910
      }, {
        longitude: 114.3925344944,
        latitude: 30.4841238539
      }, {
        longitude: 114.3918746710,
        latitude: 30.4823717616
      }, {
        longitude: 114.3909251690,
        latitude: 30.4823948765
      }],
      color: "#FF0000DD",
      width: 2,
      dottedLine: true
    }],
    // 故障反馈类型
    feedbacks: [{
      name: 'location',
      value: '校车的定位错误；定位与实际位置偏离'
    }, // { name: 'state', value: '校车颜色标示的状态与校车的实际状态不符' },
    {
      name: 'number',
      value: '校车车号不对应'
    }]
  },
  onLoad: function onLoad(options) {
    console.log("onLoad");
    var that = this;
    this.mapCtx = wx.createMapContext('myMap'); //获取当前位置

    wx.getLocation({
      type: 'gcj02',
      //返回可以用于wx.openLocation的经纬度
      success: function success(res) {
        var latitude = res.latitude;
        var longitude = res.longitude;
        that.setData({
          latitude: latitude,
          longitude: longitude
        });
      }
    });
  },
  onReady: function onReady(e) {
    // 请求车辆定位信息
    console.log("onReady");
    var that = this;
    wx.login({
      success: function success(res) {
        if (res.code) {
          var authorizeUrl = app.BASE_URL + '/user/session';
          var authorizeData = {
            code: res.code
          };
          app.request(authorizeUrl, 'POST', authorizeData, function (res) {
            console.log('/user/session');
            console.log(res);
            wx.setStorageSync('token', res.header.Authorization);
            var busPositionUrl = app.BASE_URL + '/bus/all';
            var token = wx.getStorageSync('token');
            that.setData({
              timer: setInterval(function () {
                app.request(busPositionUrl, 'GET', '', function (res) {
                  console.log(res);
                  var getLatitude = res.data.bused[0].position.latitude;
                  var getLongitude = res.data.bused[0].position.longitude.toString();
                  var getId = res.data.bused[0].id;
                  that.setData({
                    markers: [{
                      iconPath: "../img/greenBus.png",
                      id: getId,
                      latitude: getLatitude,
                      longitude: getLongitude,
                      width: 30,
                      height: 30
                    }]
                  });
                  console.log(that.data.markers);
                }, function (res) {}, {
                  'Authorization': token
                }, '');
              }, 20000)
            });
          }, function (res) {}, {
            'content-type': 'application/json'
          }, '');
        }
      }
    });
  },
  onShow: function onShow(e) {
    console.log("onShow");
  },
  // 故障反馈面板是否显示
  repair: function repair() {
    this.setData({
      boxDisplay: false,
      repairFeedbackDisplay: true
    });
  },
  // 获取checkbox的值
  checkboxChange: function checkboxChange(e) {
    this.setData({
      submitFeedback: e.detail.value
    });
  },
  //获取反馈建议texterea的值
  feedbackErea: function feedbackErea(e) {
    this.setData({
      feedbackErea: e.detail.value
    });
  },
  // 提交反馈
  submitFeedback: function submitFeedback(e) {
    var that = this;
    var feedbackData = {
      type: that.data.submitFeedback.toString(),
      text: that.data.feedbackErea
    };
    var token = wx.getStorageSync('token');
    var feedbackUrl = app.BASE_URL + '/feedback';
    app.request(feedbackUrl, 'POST', feedbackData, function (res) {
      console.log('feedbackUrl');
      console.log(res);
      wx.showToast({
        title: '成功',
        icon: 'succes',
        duration: 1000,
        mask: true
      });
      that.setData({
        repairFeedbackDisplay: false,
        boxDisplay: true
      });
    }, function (res) {}, {
      'Authorization': token
    }, '');
  },
  repairFeedbackBox: function repairFeedbackBox() {
    this.setData({
      repairFeedbackDisplay: false,
      boxDisplay: true
    });
  },
  Unload: function Unload() {
    clearInterval(this.data.timer);
  },
  clear: function clear() {
    wx.clearStorageSync();
    console.log("清除数据操作");
  }
});

/***/ })

},[[3,0]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9wYWdlcy9pbmRleC9pbmRleC5qcyJdLCJuYW1lcyI6WyJhcHAiLCJnZXRBcHAiLCJQYWdlIiwiZGF0YSIsImxvbmdpdHVkZSIsImxhdGl0dWRlIiwiYm94RGlzcGxheSIsInJlcGFpckZlZWRiYWNrRGlzcGxheSIsImRpc2FibGVkIiwidGltZXIiLCJmZWVkYmFja0VyZWEiLCJzdWJtaXRGZWVkYmFjayIsIm1hcmtlcnMiLCJpY29uUGF0aCIsImlkIiwid2lkdGgiLCJoZWlnaHQiLCJwb2x5bGluZSIsInBvaW50cyIsImNvbG9yIiwiZG90dGVkTGluZSIsImZlZWRiYWNrcyIsIm5hbWUiLCJ2YWx1ZSIsIm9uTG9hZCIsIm9wdGlvbnMiLCJjb25zb2xlIiwibG9nIiwidGhhdCIsIm1hcEN0eCIsInd4IiwiY3JlYXRlTWFwQ29udGV4dCIsImdldExvY2F0aW9uIiwidHlwZSIsInN1Y2Nlc3MiLCJyZXMiLCJzZXREYXRhIiwib25SZWFkeSIsImUiLCJsb2dpbiIsImNvZGUiLCJhdXRob3JpemVVcmwiLCJCQVNFX1VSTCIsImF1dGhvcml6ZURhdGEiLCJyZXF1ZXN0Iiwic2V0U3RvcmFnZVN5bmMiLCJoZWFkZXIiLCJBdXRob3JpemF0aW9uIiwiYnVzUG9zaXRpb25VcmwiLCJ0b2tlbiIsImdldFN0b3JhZ2VTeW5jIiwic2V0SW50ZXJ2YWwiLCJnZXRMYXRpdHVkZSIsImJ1c2VkIiwicG9zaXRpb24iLCJnZXRMb25naXR1ZGUiLCJ0b1N0cmluZyIsImdldElkIiwib25TaG93IiwicmVwYWlyIiwiY2hlY2tib3hDaGFuZ2UiLCJkZXRhaWwiLCJmZWVkYmFja0RhdGEiLCJ0ZXh0IiwiZmVlZGJhY2tVcmwiLCJzaG93VG9hc3QiLCJ0aXRsZSIsImljb24iLCJkdXJhdGlvbiIsIm1hc2siLCJyZXBhaXJGZWVkYmFja0JveCIsIlVubG9hZCIsImNsZWFySW50ZXJ2YWwiLCJjbGVhciIsImNsZWFyU3RvcmFnZVN5bmMiXSwibWFwcGluZ3MiOiI7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TCxDQUFhO0FBQ1g3Qiw2QkFBcUIsRUFBRSxLQURaO0FBRVhELGtCQUFVLEVBQUU7QUFGRCxPQUFiO0FBSUgsS0FiRCxFQWFHLFVBQUE2QixHQUFHLEVBQUksQ0FBRyxDQWJiLEVBYWU7QUFBRSx1QkFBaUJjO0FBQW5CLEtBYmYsRUFhMkMsRUFiM0M7QUFlRCxHQW5NRTtBQW9NSHFCLG1CQUFpQixFQUFDLDZCQUFVO0FBQzFCLFNBQUtsQyxPQUFMLENBQWE7QUFDWDdCLDJCQUFxQixFQUFFLEtBRFo7QUFFWEQsZ0JBQVUsRUFBRTtBQUZELEtBQWI7QUFJRCxHQXpNRTtBQTBNSGlFLFFBQU0sRUFBQyxrQkFBVTtBQUNmQyxpQkFBYSxDQUFDLEtBQUtyRSxJQUFMLENBQVVNLEtBQVgsQ0FBYjtBQUNELEdBNU1FO0FBNk1IZ0UsT0FBSyxFQUFDLGlCQUFVO0FBQ2QzQyxNQUFFLENBQUM0QyxnQkFBSDtBQUNBaEQsV0FBTyxDQUFDQyxHQUFSLENBQVksUUFBWjtBQUNEO0FBaE5FLENBQUQsQ0FBSixDIiwiZmlsZSI6InBhZ2VzXFxpbmRleFxcaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL2luZGV4LmpzXG5jb25zdCBhcHAgPSBnZXRBcHAoKVxuUGFnZSh7XG4gIGRhdGE6IHtcbiAgICBsb25naXR1ZGU6IDExMy4zMjQ1MjAsXG4gICAgbGF0aXR1ZGU6IDIzLjA5OTk5NCxcblxuICAgIGJveERpc3BsYXk6dHJ1ZSxcbiAgICByZXBhaXJGZWVkYmFja0Rpc3BsYXk6ZmFsc2UsXG5cblxuICAgIGRpc2FibGVkOiB0cnVlLFxuICAgIHRpbWVyOlwiXCIsXG4gICAgZmVlZGJhY2tFcmVhOlwiXCIsXG4gICAgc3VibWl0RmVlZGJhY2s6W10sXG4gIFxuICAgIG1hcmtlcnM6IFtcbiAgICAgIHtcbiAgICAgICAgaWNvblBhdGg6IFwiLi4vaW1nL2dyZWVuQnVzLnBuZ1wiLFxuICAgICAgICBpZDogMCxcbiAgICAgICAgbGF0aXR1ZGU6IDMwLjQ5NTIxNDUzMjMwMzg2NixcbiAgICAgICAgbG9uZ2l0dWRlOiAxMTQuMzk2NzA3NzQwOTA1MzYsXG4gICAgICAgIHdpZHRoOiAzMCxcbiAgICAgICAgaGVpZ2h0OiAzMFxuICAgICAgfVxuICAgIF0sXG4gICAgLy/ot6/nur9cbiAgICBwb2x5bGluZTogW3tcbiAgICAgIHBvaW50czogW3tcbiAgICAgICAgbG9uZ2l0dWRlOiAxMTQuMzk1MzUwODEzOSAsXG4gICAgICAgIGxhdGl0dWRlOiAzMC40OTM1MzU2MDk0IFxuICAgICAgfSwge1xuICAgICAgICAgIGxvbmdpdHVkZTogMTE0LjM5NjQ2NjYxMjgsXG4gICAgICAgICAgbGF0aXR1ZGU6IDMwLjQ5MzI5NTI0MTkgXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBsb25naXR1ZGU6IDExNC4zOTYwMzIwOTUwICxcbiAgICAgICAgICBsYXRpdHVkZTogMzAuNDkxNjIxODk3OSBcbiAgICAgICAgfSwge1xuICAgICAgICAgIGxvbmdpdHVkZTogMTE0LjM5MzQ3ODYzMjAsXG4gICAgICAgICAgbGF0aXR1ZGU6IDMwLjQ5MTkzMTYwNzRcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGxvbmdpdHVkZTogMTE0LjM5MzQ3MzI2NzYsXG4gICAgICAgICAgbGF0aXR1ZGU6IDMwLjQ5MTQ0NjI0MTMsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBsb25naXR1ZGU6IDExNC4zOTIwMzAyMzkxLFxuICAgICAgICAgIGxhdGl0dWRlOiAzMC40OTE0MzIzNzM3LCBcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGxvbmdpdHVkZTogMTE0LjM5MjA5OTk3NjUsXG4gICAgICAgICAgbGF0aXR1ZGU6IDMwLjQ5MDA3Nzk1ODMsIFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgbG9uZ2l0dWRlOiAxMTQuMzkxNTU4MTcwMyxcbiAgICAgICAgICBsYXRpdHVkZTogMzAuNDg4NjAzMzM0NCwgXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBsb25naXR1ZGU6IDExNC4zOTEzNzU3ODAxLFxuICAgICAgICAgIGxhdGl0dWRlOiAzMC40ODY0MzA2NTAzLCBcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGxvbmdpdHVkZTogMTE0LjM5MTY5NzY0NTIsXG4gICAgICAgICAgbGF0aXR1ZGU6IDMwLjQ4NDY5NzA5MTAsIFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgbG9uZ2l0dWRlOiAxMTQuMzkyNTM0NDk0NCxcbiAgICAgICAgICBsYXRpdHVkZTogMzAuNDg0MTIzODUzOSwgXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBsb25naXR1ZGU6IDExNC4zOTE4NzQ2NzEwLFxuICAgICAgICAgIGxhdGl0dWRlOiAzMC40ODIzNzE3NjE2LFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgbG9uZ2l0dWRlOiAxMTQuMzkwOTI1MTY5MCxcbiAgICAgICAgICBsYXRpdHVkZTogMzAuNDgyMzk0ODc2NSwgXG4gICAgICAgIH1dLFxuICAgICAgY29sb3I6IFwiI0ZGMDAwMEREXCIsXG4gICAgICB3aWR0aDogMixcbiAgICAgIGRvdHRlZExpbmU6IHRydWVcbiAgICB9XSxcblxuICAgIC8vIOaVhemanOWPjemmiOexu+Wei1xuICAgIGZlZWRiYWNrczogW1xuICAgICAgeyBuYW1lOiAnbG9jYXRpb24nLCB2YWx1ZTogJ+agoei9pueahOWumuS9jemUmeivr++8m+WumuS9jeS4juWunumZheS9jee9ruWBj+emuyd9LFxuICAgICAgLy8geyBuYW1lOiAnc3RhdGUnLCB2YWx1ZTogJ+agoei9puminOiJsuagh+ekuueahOeKtuaAgeS4juagoei9pueahOWunumZheeKtuaAgeS4jeespicgfSxcbiAgICAgIHsgbmFtZTogJ251bWJlcicsIHZhbHVlOiAn5qCh6L2m6L2m5Y+35LiN5a+55bqUJyB9LFxuICAgIF0sXG4gIFxuICB9LFxuICBvbkxvYWQ6IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgY29uc29sZS5sb2coXCJvbkxvYWRcIilcbiAgICBjb25zdCB0aGF0ID0gdGhpc1xuICAgIHRoaXMubWFwQ3R4ID0gd3guY3JlYXRlTWFwQ29udGV4dCgnbXlNYXAnKVxuICAgIC8v6I635Y+W5b2T5YmN5L2N572uXG4gICAgd3guZ2V0TG9jYXRpb24oe1xuICAgICAgdHlwZTogJ2djajAyJywgLy/ov5Tlm57lj6/ku6XnlKjkuo53eC5vcGVuTG9jYXRpb27nmoTnu4/nuqzluqZcbiAgICAgIHN1Y2Nlc3MocmVzKSB7XG4gICAgICAgIGNvbnN0IGxhdGl0dWRlID0gcmVzLmxhdGl0dWRlXG4gICAgICAgIGNvbnN0IGxvbmdpdHVkZSA9IHJlcy5sb25naXR1ZGVcbiAgICAgICAgdGhhdC5zZXREYXRhKHtcbiAgICAgICAgICBsYXRpdHVkZTogbGF0aXR1ZGUsXG4gICAgICAgICAgbG9uZ2l0dWRlOiBsb25naXR1ZGUsXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSlcbiAgfSxcbiAgb25SZWFkeTogZnVuY3Rpb24gKGUpIHtcbiAgICAvLyDor7fmsYLovabovoblrprkvY3kv6Hmga9cbiAgICBjb25zb2xlLmxvZyhcIm9uUmVhZHlcIilcbiAgICBjb25zdCB0aGF0ID0gdGhpc1xuXG4gICAgd3gubG9naW4oe1xuICAgICAgc3VjY2VzczogcmVzID0+IHtcbiAgICAgICAgaWYgKHJlcy5jb2RlKSB7XG4gICAgICAgICAgbGV0IGF1dGhvcml6ZVVybCA9IGFwcC5CQVNFX1VSTCArICcvdXNlci9zZXNzaW9uJ1xuICAgICAgICAgIGxldCBhdXRob3JpemVEYXRhID0geyBjb2RlOiByZXMuY29kZSB9XG4gICAgICAgICAgYXBwLnJlcXVlc3QoYXV0aG9yaXplVXJsLCAnUE9TVCcsIGF1dGhvcml6ZURhdGEsIHJlcyA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnL3VzZXIvc2Vzc2lvbicpXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpXG4gICAgICAgICAgICB3eC5zZXRTdG9yYWdlU3luYygndG9rZW4nLCByZXMuaGVhZGVyLkF1dGhvcml6YXRpb24pXG4gICAgICAgICAgICBjb25zdCBidXNQb3NpdGlvblVybCA9IGFwcC5CQVNFX1VSTCArICcvYnVzL2FsbCdcbiAgICAgICAgICAgIGNvbnN0IHRva2VuID0gd3guZ2V0U3RvcmFnZVN5bmMoJ3Rva2VuJylcbiAgICAgICAgICAgIHRoYXQuc2V0RGF0YSh7XG4gICAgICAgICAgICAgIHRpbWVyOiBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgYXBwLnJlcXVlc3QoYnVzUG9zaXRpb25VcmwsICdHRVQnLCAnJywgcmVzID0+IHtcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcylcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGdldExhdGl0dWRlID0gcmVzLmRhdGEuYnVzZWRbMF0ucG9zaXRpb24ubGF0aXR1ZGVcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGdldExvbmdpdHVkZSA9IHJlcy5kYXRhLmJ1c2VkWzBdLnBvc2l0aW9uLmxvbmdpdHVkZS50b1N0cmluZygpXG4gICAgICAgICAgICAgICAgICBjb25zdCBnZXRJZCA9IHJlcy5kYXRhLmJ1c2VkWzBdLmlkXG4gICAgICAgICAgICAgICAgICB0aGF0LnNldERhdGEoe1xuICAgICAgICAgICAgICAgICAgICBtYXJrZXJzOiBbXG4gICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWNvblBhdGg6IFwiLi4vaW1nL2dyZWVuQnVzLnBuZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGdldElkLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGF0aXR1ZGU6IGdldExhdGl0dWRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbG9uZ2l0dWRlOiBnZXRMb25naXR1ZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMzAsXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDMwXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2codGhhdC5kYXRhLm1hcmtlcnMpXG4gICAgICAgICAgICAgICAgfSwgcmVzID0+IHsgfSwgeyAnQXV0aG9yaXphdGlvbic6IHRva2VuIH0sICcnKVxuICAgICAgICAgICAgICB9LCAyMDAwMClcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSwgcmVzID0+IHsgfSwgeyAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sICcnKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSkgXG5cbiAgfSwgIFxuICBvblNob3c6IGZ1bmN0aW9uIChlKSB7XG4gICAgY29uc29sZS5sb2coXCJvblNob3dcIilcbiAgfSxcbiAgXG4vLyDmlYXpmpzlj43ppojpnaLmnb/mmK/lkKbmmL7npLpcbiAgcmVwYWlyOmZ1bmN0aW9uKCl7XG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIGJveERpc3BsYXk6IGZhbHNlLFxuICAgICAgcmVwYWlyRmVlZGJhY2tEaXNwbGF5OiB0cnVlLFxuICAgIH0pXG4gIH0sXG4gIC8vIOiOt+WPlmNoZWNrYm9455qE5YC8XG4gIGNoZWNrYm94Q2hhbmdlOiBmdW5jdGlvbiAoZSkge1xuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBzdWJtaXRGZWVkYmFjazogZS5kZXRhaWwudmFsdWVcbiAgICB9KVxuICB9LFxuICAvL+iOt+WPluWPjemmiOW7uuiurnRleHRlcmVh55qE5YC8XG4gIGZlZWRiYWNrRXJlYTogZnVuY3Rpb24gKGUpIHtcbiAgICB0aGlzLnNldERhdGEoe1xuICAgICAgZmVlZGJhY2tFcmVhOiBlLmRldGFpbC52YWx1ZVxuICAgIH0pXG4gIH0sXG4gIC8vIOaPkOS6pOWPjemmiFxuICBzdWJtaXRGZWVkYmFjazpmdW5jdGlvbihlKXtcbiAgICBjb25zdCB0aGF0ID0gdGhpc1xuICAgIGNvbnN0IGZlZWRiYWNrRGF0YSA9IHsgdHlwZTogdGhhdC5kYXRhLnN1Ym1pdEZlZWRiYWNrLnRvU3RyaW5nKCksIHRleHQ6IHRoYXQuZGF0YS5mZWVkYmFja0VyZWF9XG4gICAgY29uc3QgdG9rZW4gPSB3eC5nZXRTdG9yYWdlU3luYygndG9rZW4nKVxuICAgIGNvbnN0IGZlZWRiYWNrVXJsID0gYXBwLkJBU0VfVVJMICsgJy9mZWVkYmFjaydcblxuICAgIGFwcC5yZXF1ZXN0KGZlZWRiYWNrVXJsLCAnUE9TVCcsIGZlZWRiYWNrRGF0YSwgcmVzID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCdmZWVkYmFja1VybCcpXG4gICAgICBjb25zb2xlLmxvZyhyZXMpXG4gICAgICB3eC5zaG93VG9hc3Qoe1xuICAgICAgICB0aXRsZTogJ+aIkOWKnycsXG4gICAgICAgICAgICBpY29uOiAnc3VjY2VzJyxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAwLFxuICAgICAgICAgICAgbWFzazp0cnVlXG4gICAgICAgIH0pXG4gICAgICAgIHRoYXQuc2V0RGF0YSh7XG4gICAgICAgICAgcmVwYWlyRmVlZGJhY2tEaXNwbGF5OiBmYWxzZSxcbiAgICAgICAgICBib3hEaXNwbGF5OiB0cnVlLFxuICAgICAgICB9KVxuICAgIH0sIHJlcyA9PiB7IH0sIHsgJ0F1dGhvcml6YXRpb24nOiB0b2tlbiB9LCAnJylcblxuICB9LFxuICByZXBhaXJGZWVkYmFja0JveDpmdW5jdGlvbigpe1xuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICByZXBhaXJGZWVkYmFja0Rpc3BsYXk6IGZhbHNlLFxuICAgICAgYm94RGlzcGxheTogdHJ1ZSxcbiAgICB9KVxuICB9LFxuICBVbmxvYWQ6ZnVuY3Rpb24oKXtcbiAgICBjbGVhckludGVydmFsKHRoaXMuZGF0YS50aW1lcilcbiAgfSxcbiAgY2xlYXI6ZnVuY3Rpb24oKXtcbiAgICB3eC5jbGVhclN0b3JhZ2VTeW5jKClcbiAgICBjb25zb2xlLmxvZyhcIua4hemZpOaVsOaNruaTjeS9nFwiKVxuICB9XG59KVxuIl0sInNvdXJjZVJvb3QiOiIifQ==